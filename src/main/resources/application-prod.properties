# ==============================================================
# AMBIENTE DE PRODUÇÃO (PROD) - MySQL
# ==============================================================

# --- CONEXÃO COM O BANCO MYSQL ---
spring.datasource.url=jdbc:mysql://${DB_HOST}:3306/${DB_NAME}?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC&rewriteBatchedStatements=true
spring.datasource.username=${DB_USER}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# --- POOL DE CONEXÕES (HikariCP) - Otimizado ---
# Mantém conexões prontas para não ter delay na primeira venda
spring.datasource.hikari.minimum-idle=5
# Limite seguro para servidores compartilhados
spring.datasource.hikari.maximum-pool-size=20
# Tempo máximo de vida da conexão (30 min) para evitar erros de timeout
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.connection-timeout=30000
# Teste de conexão (Performance)
spring.datasource.hikari.pool-name=HikariPool-DDCosmeticos

# --- JPA / HIBERNATE ---
# 'validate' verifica se o banco bate com o código, mas NÃO altera tabelas (Segurança)
# Se precisar alterar tabelas em produção, mude temporariamente para 'update'
spring.jpa.hibernate.ddl-auto=validate

spring.jpa.show-sql=false
spring.jpa.open-in-view=false
spring.jpa.database-platform=org.hibernate.dialect.MySQL8Dialect

# --- PERFORMANCE DE INSERT/UPDATE ---
# Salva em blocos de 50 registros (Crucial para importação de notas fiscais)
spring.jpa.properties.hibernate.jdbc.batch_size=50
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# --- SEGURANÇA ---
spring.h2.console.enabled=false
springdoc.api-docs.enabled=false
springdoc.swagger-ui.enabled=false

# Segredos via Variável de Ambiente
api.security.token.secret=${JWT_SECRET}
cors.allowed-origins=https://lojaddcosmeticos.com.br,https://app.lojaddcosmeticos.com.br